#!/bin/sh

# Select a picture and set it as the wallpaper
[ -f "$1" ] && cp "$1" $HOME/.config/wallpaper/wal.png && notify-send -i "$HOME/.config/wallpaper/wal.png" "Wallpaper ($HOME/.config/wallpaperwal.png) changed."
# If "$1" is a directory, select a random picture
[ -d "$1" ] && cp "$(find "$1" -type f | shuf -n 1)" $HOME/.config/wallpaper/wal.png && notify-send -i "$HOME/.config/wallpaper/wal.png" "Random Wallpaper choseni."

# If pywall ist installed (and enabled) update colors
type wal >/dev/null 2>&1 && { wal -c
    wal -s -i $HOME/.config/wallpaper/wal.png -o $HOME/.config/wallpaper/postrun
    xsetroot -name "fsignal:xrdb"
    killall dwmblocks
    setsid dwmblocks >/dev/null & } >/dev/null 2>&1

# Use Xwallaper if in an Xorg sesiion
[ $(loginctl show-session "$XDG_SESSION_ID" -p Type) = "Type=tty" ] &&
    xwallpaper --zoom $HOME/.config/wallpaper/wal.png &&
    xdotool key alt+F5 # refresh dwm colors (for pywall)

# Use sww if in an Xorg sesiion
[ $(loginctl show-session "$XDG_SESSION_ID" -p Type) = "Type=wayland" ] &&
    swww img $HOME/.config/wallpaper/wal.png --transition-fps 60 --transition-type grow --transition-duration 2
